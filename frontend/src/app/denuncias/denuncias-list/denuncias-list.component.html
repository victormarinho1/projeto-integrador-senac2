<h2 class="text-2xl font-semibold text-primary-surface mb-6 border-b pb-3 justify-center">
    ðŸ“‹ Lista de DenÃºncias
</h2>
<p-table [value]="denuncias" [paginator]="true" [rows]="5" [tableStyle]="{ 'min-width': '50rem' }"
    [rowsPerPageOptions]="[5, 10, 20]">

    <ng-template #header>
        <tr>
            <th>Protocolo</th>
            <th>Imagem</th>
            <th>Cidade</th>
            <th>Prioridade</th>
            <th>SituaÃ§Ã£o</th>
            <th>AÃ§Ãµes</th>
        </tr>
        <tr>
            <th>
                <p-columnFilter type="text" field="protocolo" placeholder="Type to search" ariaLabel="Filter Name"
                    filterOn="input" [showMenu]="false"></p-columnFilter>

            </th>
            <th></th>
            <th></th>
             <th>
                <p-columnFilter field="prioridade" matchMode="equals">
                    <ng-template #filter let-value let-filter="filterCallback">
                        <p-select [options]="statuses2" optionLabel="name" optionValue="value"
                            (onChange)="filter($event.value)" placeholder="Select One" [showClear]="true"
                            style="min-width: 12rem">
                            <ng-template let-option #item>
                                <p-tag [severity]="getSeverity2(option.value)" [value]="option.name" />
                            </ng-template>
                        </p-select>

                    </ng-template>
                </p-columnFilter>
            </th>
            <th>
                <p-columnFilter field="status" matchMode="equals" [showMenu]="true">
                    <ng-template #filter let-value let-filter="filterCallback">
                        <p-select [options]="statuses" optionLabel="name" optionValue="value"
                            (onChange)="filter($event.value)" placeholder="Select One" [showClear]="true"
                            style="min-width: 12rem">
                            <ng-template let-option #item>
                                <p-tag [severity]="getSeverity(option.value)" [value]="option.name" />
                            </ng-template>
                        </p-select>

                    </ng-template>
                </p-columnFilter>
            </th>
            <th></th>
        </tr>
    </ng-template>
    <ng-template #body let-denuncia>
        <tr>
            <td>{{ denuncia.protocolo }}</td>
            <td>
                <img [src]="'http://localhost:8080/images/' + (denuncia.imagens?.[0]?.url || '')"
                    [alt]="denuncia.name" class="w-24 rounded" (error)="onImageError($event)" />
            </td>
            <td>{{ denuncia.cidade }}</td>
            <td>
              @if(denuncia.prioridade == null){
                <p-tag [severity]="getSeverity2(denuncia.prioridade)" value="Sem anÃ¡lise" />
              }@else{
                <p-tag [severity]="getSeverity2(denuncia.prioridade)" [value]="denuncia.prioridade" />

              }
            </td>
            <td>
                <p-tag [severity]="getSeverity(denuncia.status)" [value]="denuncia.status" />
            </td>
           <td>
  @if(denuncia.status === 'NOVA') {
  <p-button
    label="Atender Denuncia"
    icon="pi pi-pencil"
    [routerLink]="['/atender-denuncia', denuncia.protocolo]"
  />
  } @if(denuncia.status === 'EM_ANDAMENTO') {
  <p-button
    label="Continuar Atendimento"
    icon="pi pi-search"
    styleClass="p-button-outlined"
    [routerLink]="['/atender-denuncia', denuncia.protocolo]"
  />
  } @if(denuncia.status === 'CONCLUIDA') {
  <p-button
    label="Ver Detalhes"
    icon="pi pi-eye"
    styleClass="p-button-secondary p-button-outlined"
    [routerLink]="['/atender-denuncia', denuncia.protocolo]"
  />
  }
</td>
        </tr>

    </ng-template>
</p-table>
